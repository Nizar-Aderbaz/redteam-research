# Detection Rules

## What is YARA?
YARA is a pattern-matching tool for identifying malware based on code signatures and behaviors. It works like a "fingerprint scanner" for malicious code patterns.

## Quick Usage
```bash
# Install YARA, then:
yara rule.yar file-to-scan.exe
```

## YARA Rules

### Rule : Self_Deletion_Technique
```yara
rule Self_Deletion_Technique {
    meta:
        author = "NIZAR ADERBAZ"
        description = "Advanced detection for self-deletion with stream manipulation"
        date = "2025"
        severity = "Critical"
    
    strings:
        $s1 = "GetModuleFileNameW" wide ascii
        $s2 = "SetFileInformationByHandle" wide ascii
        $s3 = "CreateFileW" wide ascii
        $s4 = "DELETE" wide ascii
        $s5 = "FILE_FLAG_OPEN_REPARSE_POINT" wide ascii
        $s6 = "FileRenameInfo" wide ascii
        $s7 = "FileDispositionInfo" wide ascii
        $s8 = ":NEWDATA" wide ascii
        $s9 = ":$DATA" wide ascii
        $s10 = "HeapAlloc" wide ascii
        
    condition:
        (filesize < 150KB) and 
        (uint16(0) == 0x5A4D) and
        (
            (6 of ($s*)) or
            (all of ($s1, $s2, $s3) and any of ($s6, $s7)) or
            ($s8 and $s9)
        )
}

