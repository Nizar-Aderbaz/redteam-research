# Detection Rules

## What is YARA?
YARA is a tool that helps identify and classify malware patterns. Think of it as a "fingerprint scanner" for malicious code - it looks for specific text patterns in files to detect suspicious software.

## Quick Usage Guide
1. **Install YARA**: Download from https://github.com/VirusTotal/yara
2. **Save the rules below** in a `.yar` file
3. **Scan files**: `yara rule.yar file-to-scan.exe`

## YARA Rules

### Rule : Registry Persistence Technique
```yara
rule Registry_Persistence_Technique {
    meta:
        author = "NIZAR ADERBAZ"
        description = "Detects registry persistence technique"
        date = "2025"
        severity = "High"
    
    strings:
        $reg_create = "RegCreateKeyExA" wide ascii
        $reg_set = "RegSetValueExA" wide ascii
        $reg_open = "RegOpenKeyExA" wide ascii
        $reg_query = "RegQueryValueExA" wide ascii
        $software_key = "Software\\\\MySafeDemo" wide ascii
        
    condition:
        (filesize < 50KB) and 
        (uint16(0) == 0x5A4D) and
        (3 of ($reg_*))
}
